{{ define "main" }}
    {{ partial "components/heading-with-read-time" (dict "title" .Title "toCount" .Params.description)}}

    <!-- <div class="mt-5 row">
        <h2>{{ .Params.year }}</h2>
    </div> -->

    <div class="row mt-5 mt-md-5">
        <div class="col-lg-5 col-lg-4">
            <img class="w-100" src="{{ .Params.Image }}" alt="{{ .Title }}">
        </div>

        <div class="mt-5 mt-lg-0 col-lg-6 offset-lg-1">
            {{ .Description | markdownify }}
        </div>
    </div>

    <!-- Linked persons and organizations -->
    {{if or .Params.Persons .Params.organizations}}
      <div class="d-flex mt-5 mb-5 align-items-center">
        <h2 class="mb-0 me-5">Personne(s) et organisation(s) en lien avec {{ .Title}}</h2>
        <hr class="w-auto flex-grow-1">
      </div>

      {{ if or (and .Params.persons (gt (len .Params.persons) 0)) (and .Params.organizations (gt (len .Params.organizations) 0))  }}
          <div class="row mb-6">
              {{ range .Params.persons }}
                  {{ $path := printf "/%s" . }}
                  {{ with $.Site.GetPage $path }}
                      {{ partial "components/cards/person" . }}
                  {{ end }}
              {{ end }}
              {{ range .Params.organizations }}
                  {{ $path := printf "/%s" . }}
                  {{ with $.Site.GetPage $path }}
                      {{ partial "components/cards/organization" . }}
                  {{ end }}
              {{ end }}
          </div>
      {{ end }}
    {{ end }}

    <!-- Others events this year -->
{{ $events := where .Site.Pages ".Params.Year" "==" .Params.Year }}
    {{ if gt (len $events) 1 }}
    <div class="d-flex mt-5 mb-5 align-items-center">
      <h2 class="mb-0 me-5">Événements à la même date</h2>
      <hr class="w-auto flex-grow-1">
    </div>

        <div class="row mb-6 grid-masonry">

            {{ $currentPageTitle := .Title }}
            {{ range $events }}
                {{ if ne .Title $currentPageTitle }}
                    {{ partial "components/cards/event" . }}
                {{ end }}
            {{ end }}
         </div>
    {{ else }}
    <div class="mt-5"></div>
    {{ end }}
{{ end }}
